# chess_game_config 配置表说明文档

## 表概述
`chess_game_config` 是用于存储中国象棋自动化训练和自我对弈相关配置参数的配置表。该表包含了控制对弈过程、训练流程和系统行为的各项参数。

## 表结构

### 基本信息
- **表名**: `chess_game_config`
- **描述**: 对弈数据配置表，包含对弈相关参数配置
- **用途**: 存储自动化象棋训练系统的配置参数

### 字段定义

| 字段名 | 类型 | 必填 | 默认值 | 描述 |
|--------|------|------|--------|------|
| `data_file_path` | string | 是 | `./data/chess_games/` | 数据文件存储路径 |
| `use_multithreading` | boolean | 是 | `false` | 是否使用多线程 |
| `thread_count` | integer | 否 | `4` | 多线程数 |
| `game_count` | integer | 是 | `100` | 对弈局数 |
| `total_rounds` | integer | 是 | `10` | 总轮数 |
| `timeout_seconds` | integer | 否 | `30` | 每步超时时间(秒) |
| `save_interval` | integer | 否 | `10` | 保存间隔(局) |
| `model_update_interval` | integer | 是 | `60` | 模型更新间隔(分钟) |
| [temp](file://E:\code\Embodied\src\cchessAI\auto_train_selfplay.py#L0-L0) | float | 是 | `1.0` | 温度参数 |
| [cpuct](file://E:\code\Embodied\src\cchessAI\auto_train_selfplay.py#L0-L0) | float | 是 | `5.0` | CPUCT参数 |
| [collect_mode](file://E:\code\Embodied\src\cchessAI\auto_train_selfplay.py#L0-L0) | string | 是 | `multi_thread` | 采集模式(multi_thread/single_gpu) |
| [use_gpu](file://E:\code\Embodied\src\cchessAI\auto_train_selfplay.py#L0-L0) | boolean | 是 | `true` | 是否使用GPU |
| `last_training_start` | string | 否 | null | 上次训练开始时间 |
| `last_training_end` | string | 否 | null | 上次训练结束时间 |
| `last_selfplay_complete` | string | 否 | null | 上次自我对弈完成时间 |
| `next_training_time` | string | 否 | null | 下次训练计划时间 |

## 配置参数详解

### 1. 对弈控制参数

#### data_file_path
- **类型**: 字符串
- **说明**: 存储对弈数据文件的目录路径
- **示例**: `./data/chess_games/`, `/home/user/chess_data/`

#### use_multithreading
- **类型**: 布尔值
- **说明**: 是否启用多线程进行对弈
- **建议值**: `true` (生产环境), `false` (调试环境)

#### thread_count
- **类型**: 整数
- **说明**: 并行对弈的线程数量
- **建议值**: CPU核心数的75%-100%

#### game_count
- **类型**: 整数
- **说明**: 每轮自我对弈的局数
- **建议值**: 100-1000 (根据硬件性能调整)

#### total_rounds
- **类型**: 整数
- **说明**: 自我对弈的总轮数
- **建议值**: 10-100

#### timeout_seconds
- **类型**: 整数
- **说明**: 每步思考的超时时间（秒）
- **建议值**: 30-300

#### save_interval
- **类型**: 整数
- **说明**: 每隔多少局保存一次数据
- **建议值**: 10-100

### 2. 训练控制参数

#### model_update_interval
- **类型**: 整数（分钟）
- **说明**: 模型自动更新的时间间隔
- **建议值**: 30-120

#### temp
- **类型**: 浮点数
- **说明**: MCTS搜索的温度参数，控制探索与利用的平衡
- **建议值**: 1.0 (训练), 0.1 (比赛)

#### cpuct
- **类型**: 浮点数
- **说明**: MCTS的CPUCT参数，影响搜索的广度和深度
- **建议值**: 3.0-7.0

#### collect_mode
- **类型**: 字符串
- **说明**: 数据采集模式
- **可选值**:
  - `multi_thread`: 多线程模式
  - `single_gpu`: 单GPU模式

#### use_gpu
- **类型**: 布尔值
- **说明**: 是否使用GPU加速
- **建议值**: `true` (有GPU时), `false` (仅CPU)

### 3. 状态跟踪参数

#### last_training_start
- **类型**: 字符串（ISO时间格式）
- **说明**: 记录上次训练开始的时间

#### last_training_end
- **类型**: 字符串（ISO时间格式）
- **说明**: 记录上次训练结束的时间

#### last_selfplay_complete
- **类型**: 字符串（ISO时间格式）
- **说明**: 记录上次自我对弈完成的时间

#### next_training_time
- **类型**: 字符串（时间戳）
- **说明**: 计划下次训练的时间

## 使用示例

### 1. 获取配置
```bash
# 通过API获取配置
curl http://localhost:8080/config-tables/chess_game_config/data
```


### 2. 更新配置
```bash
# 更新对弈局数
curl -X POST http://localhost:8080/config-tables/chess_game_config/data \
  -H "Content-Type: application/json" \
  -d '{"config_key": "game_count", "config_value": 200, "description": "增加对弈局数"}'
```


### 3. 使用runner脚本
```bash
# 获取当前配置
python runner/autoTrainSelfPlay_runner.py --action get-config

# 更新配置值
python runner/autoTrainSelfPlay_runner.py --action update-config \
  --config-key thread_count --config-value 8

# 启动训练流程
python runner/autoTrainSelfPlay_runner.py --action start --workers 6
```


## 最佳实践

### 1. 性能调优
- 根据硬件配置调整 `thread_count` 和 `game_count`
- 监控系统资源使用情况，避免过载
- 合理设置 `model_update_interval` 平衡训练频率和系统负载

### 2. 参数调优
- [temp](file://E:\code\Embodied\src\cchessAI\auto_train_selfplay.py#L0-L0) 参数在训练初期可设为较高值(1.0)，后期逐渐降低(0.1-0.3)
- [cpuct](file://E:\code\Embodied\src\cchessAI\auto_train_selfplay.py#L0-L0) 参数通常在3-7之间，可根据具体情况进行调整
- `timeout_seconds` 根据模型复杂度和硬件性能设置

### 3. 数据管理
- 定期清理旧的对弈数据文件
- 确保 `data_file_path` 指向的目录有足够存储空间
- 启用备份功能防止数据丢失

### 4. 监控和维护
- 定期检查状态跟踪字段了解系统运行状况
- 监控训练和对弈的完成情况
- 根据实际运行效果调整配置参数

## 注意事项

1. **数据一致性**: 修改配置后可能需要重启相关服务才能生效
2. **资源限制**: 避免设置过高的并行度导致系统资源耗尽
3. **路径权限**: 确保 `data_file_path` 指向的目录具有读写权限
4. **备份策略**: 重要配置建议定期备份
5. **版本兼容**: 更新配置时注意与代码版本的兼容性